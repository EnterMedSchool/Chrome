/**
 * EnterMedSchool Glossary - Term Highlighting Styles
 * Injected into web pages to style highlighted terms.
 * Uses CSS variables for customization.
 */

:root {
  --ems-highlight-color: #6C5CE7;
  --ems-highlight-hover-bg: rgba(108, 92, 231, 0.15);
}

/* Base term styles - NO transition on initial load to prevent flicker */
.ems-term {
  position: relative;
  cursor: pointer;
}

/* Focus state for keyboard navigation */
.ems-term:focus {
  outline: 2px solid var(--ems-highlight-color);
  outline-offset: 2px;
  border-radius: 2px;
}

/* Underline style (default) */
.ems-term--underline {
  text-decoration: underline;
  text-decoration-color: var(--ems-highlight-color);
  text-decoration-thickness: 2px;
  text-underline-offset: 3px;
  text-decoration-style: solid;
}

.ems-term--underline:hover {
  text-decoration-thickness: 3px;
  background-color: var(--ems-highlight-hover-bg);
  border-radius: 2px;
  transition: text-decoration-thickness 0.15s ease, background-color 0.15s ease;
}

/* Background style */
.ems-term--background {
  background-color: rgba(108, 92, 231, 0.15);
  padding: 0 0.2em;
  border-radius: 3px;
  box-decoration-break: clone;
  -webkit-box-decoration-break: clone;
}

.ems-term--background:hover {
  background-color: rgba(108, 92, 231, 0.3);
  transition: background-color 0.15s ease;
}

/* Bold style */
.ems-term--bold {
  font-weight: 700;
  color: var(--ems-highlight-color);
}

.ems-term--bold:hover {
  text-decoration: underline;
  text-decoration-color: var(--ems-highlight-color);
  transition: text-decoration 0.15s ease;
}

/* Disambiguation indicator (multiple matches) */
.ems-term--multi::after {
  content: '▾';
  font-size: 0.7em;
  margin-left: 0.2em;
  opacity: 0.7;
  vertical-align: super;
  color: var(--ems-highlight-color);
}

/* Ensure visibility on dark backgrounds */
@media (prefers-color-scheme: dark) {
  :root {
    --ems-highlight-hover-bg: rgba(108, 92, 231, 0.25);
  }
}

/* Reduce motion if user prefers */
@media (prefers-reduced-motion: reduce) {
  .ems-term--underline:hover,
  .ems-term--background:hover,
  .ems-term--bold:hover {
    transition: none;
  }
}

/* Terms inside links - show external link indicator */
a .ems-term::after,
a.ems-term::after {
  content: '↗';
  font-size: 0.65em;
  margin-left: 0.15em;
  opacity: 0.6;
  vertical-align: super;
  color: var(--ems-highlight-color);
}

/* If term is both multi-match AND in a link, show both indicators */
a .ems-term--multi::after,
a.ems-term--multi::after {
  content: '↗▾';
}

/* Hint on hover for terms in links */
a .ems-term:hover::before,
a.ems-term:hover::before {
  content: 'Ctrl+Click for link';
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  padding: 4px 8px;
  font-size: 11px;
  background: rgba(0, 0, 0, 0.8);
  color: #fff;
  border-radius: 4px;
  white-space: nowrap;
  pointer-events: none;
  opacity: 0;
  animation: ems-hint-fade-in 0.2s ease 0.5s forwards;
  z-index: 10000;
}

@keyframes ems-hint-fade-in {
  to {
    opacity: 1;
  }
}
